<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, user-scalable=no"
    />
    <link rel="stylesheet" href="./main.css" type="text/css" />
    <link href="./favicon.ico" type="ico" />
  </head>
  <body>
      <div class="content">
        <h1>tsiny <img src="./tsiny.png"  width="30" height="30" class="welcome"/></h1>
        

        <div class="description">
          url shortener service
        </div>

        <div class="url_shortener">
          <input id="long_url" placeholder="input long URL..." size="29" />
          <button onclick="send()">Send</button><br />
          <div id="result"></div>
        </div>

        <p class="copyright">
          Tal Hayut &copy; 2020;
        </p>
        <div class="github-btn">
          <iframe src="https://ghbtns.com/github-btn.html?user=tool3&repo=tsiny&type=star" frameBorder="0" scrolling="0" width="60" height="20" title="GitHub"></iframe>
          <iframe src="https://ghbtns.com/github-btn.html?user=tool3&type=follow" frameBorder="0" scrolling="0" width="117" height="20" title="GitHub"></iframe>
          <iframe src="https://ghbtns.com/github-btn.html?user=tool3&repo=tsiny&type=fork" frameBorder="0" scrolling="0" width="60" height="20" title="GitHub"></iframe>
      </div>
      </div>
    </div>
  </body>
  <script>
    async function send() {
      const input = document.getElementById("long_url").value;
      const json = JSON.stringify({ url : input });
      try {
        const result = await fetch("https://tsiny.herokuapp.com/shorten", { method: "POST", headers: { "Content-Type": "application/json" }, body: json, json: true });
        const responseObj = await result.json()
        const target = document.getElementById("result");
        const element = document.createElement("a")
        element.href = responseObj.short_url;
        element.innerHTML = responseObj.short_url;
        target.innerHTML = element;
        console.info(responseObj.short_url);
      } catch (error) {
        alert(error);
      }
    }
  </script>
</html>
